
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Calculadora de Inter√©s Compuesto</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://img.icons8.com/fluency/48/calculator.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-light: #f4f7fb;
            --card-light: #ffffff;
            --text-light: #2c3e50;
            --accent1: #4f46e5;
            --accent2: #14b8a6;
            --accent3: #9333ea;

            --bg-dark: #121212;
            --card-dark: #1e1e1e;
            --text-dark: #f4f4f4;
        }
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-light);
            color: var(--text-light);
            transition: background 0.3s ease, color 0.3s ease;
        }
        body.dark {
            background-color: var(--bg-dark);
            color: var(--text-dark);
        }
        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--accent1), var(--accent2));
            color: white;
        }
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        .theme-toggle {
            position: fixed;
            top: 15px;
            right: 15px;
            background: var(--accent1);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.4rem;
            color: white;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .theme-toggle:hover {
            transform: scale(1.1);
        }
        .container {
            max-width: 1200px;
            margin: auto;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
        }
        .card {
            flex: 1;
            min-width: 320px;
            background: var(--card-light);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0px 4px 15px rgba(0,0,0,0.1);
            transition: background 0.3s ease;
        }
        body.dark .card {
            background: var(--card-dark);
        }
        label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-size: 1rem;
            margin-top: 5px;
        }
        .result {
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            margin-top: 20px;
            color: var(--accent2);
        }
        button {
            margin-top: 20px;
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            background: var(--accent1);
            color: white;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        button:hover {
            background: var(--accent3);
        }
        canvas {
            max-height: 300px;
        }
    </style>
</head>
<body>
    <button class="theme-toggle" id="themeToggle">üåô</button>
    <header>
        <h1>Calculadora de Inter√©s Compuesto</h1>
        <p>Descubre el poder del inter√©s compuesto y c√≥mo hacer crecer tu dinero con el tiempo.</p>
<p style='font-style:italic; font-size:1rem; margin-top:10px; opacity:0.9;'>"El inter√©s compuesto es la octava maravilla del mundo. Quien lo entiende, lo gana; quien no, lo paga." ‚Äì Albert Einstein</p>
    </header>
    <div class="container">
        <div class="card">
            <label>Moneda:</label>
            <select id="currency">
                <option value="EUR">‚Ç¨ - Euro</option>
                <option value="USD">$ - D√≥lar</option>
                <option value="MXN">$ - Peso Mexicano</option>
            </select>
            <label>Capital inicial:</label>
            <input type="number" id="principal" value="1000">
            <label>Tasa anual (%):</label>
            <input type="number" id="rate" value="5" step="0.01">
            <label>A√±os:</label>
            <input type="number" id="years" value="10">
            <label>Aportaci√≥n peri√≥dica:</label>
            <input type="number" id="contribution" value="100">
            <label>Frecuencia:</label>
            <select id="frequency">
                <option value="12">Mensual</option>
                <option value="1">Anual</option>
            </select>
            <button onclick="downloadPDF()">Descargar PDF</button>
            <div class="result" id="result">0,00 ‚Ç¨</div>
<p id="explanation" style="text-align:center; margin-top:10px; font-size:1rem; opacity:0.8;"></p>
<div id="table-container" style="margin-top:20px; overflow-x:auto;"></div>
        </div>
        <div class="card">
            <canvas id="lineChart"></canvas>
            <canvas id="pieChart"></canvas>
<canvas id="barChartExtra"></canvas>
<div id="finalConclusion" style="text-align:center; margin-top:15px; font-weight:bold; font-size:1rem; opacity:0.85;"></div>
        </div>
    </div>
    <script>
        const inputs = document.querySelectorAll("#currency, #principal, #rate, #years, #contribution, #frequency");
        const resultEl = document.getElementById("result");

        let lineChart, pieChart;

        function getCurrencySymbol(code) {
            return { EUR: "‚Ç¨", USD: "$", MXN: "$" }[code] || "‚Ç¨";
        }

        function formatNumber(num, currency) {
            return num.toLocaleString('es-ES', { style: 'currency', currency: currency });
        }

        function calculate() {
            const currency = document.getElementById('currency').value;
            const principal = parseFloat(document.getElementById('principal').value);
            const rate = parseFloat(document.getElementById('rate').value) / 100;
            const years = parseInt(document.getElementById('years').value);
            const contribution = parseFloat(document.getElementById('contribution').value);
            const frequency = parseInt(document.getElementById('frequency').value);

            let total = principal;
            const yearlyData = [principal];
            let totalContributions = 0;

            for (let i = 1; i <= years; i++) {
                for (let j = 0; j < frequency; j++) {
                    total += contribution;
                    total *= (1 + rate / frequency);
                }
                yearlyData.push(total);
                totalContributions += contribution * frequency;
            }

            const interests = total - (principal + totalContributions);
            resultEl.textContent = formatNumber(total, currency);

            const explanationEl = document.getElementById("explanation");
            const tableContainer = document.getElementById("table-container");

            let tableHTML = "<table style='width:100%; border-collapse:collapse; margin-top:15px;'>";
            tableHTML += "<thead><tr style='background:#4f46e5; color:white;'><th style='padding:8px;'>A√±o</th><th style='padding:8px;'>Capital Aportado</th><th style='padding:8px;'>Intereses</th><th style='padding:8px;'>Capital Total</th></tr></thead><tbody>";

            for (let i = 1; i <= years; i++) {
                const capitalAportado = principal + (contribution * frequency * i);
                const interesesAcumulados = yearlyData[i] - capitalAportado;
                tableHTML += "<tr style='border-bottom:1px solid #ccc; text-align:right;'>"
                           + `<td style='padding:6px;'>${i}</td>`
                           + `<td style='padding:6px;'>${formatNumber(capitalAportado, currency)}</td>`
                           + `<td style='padding:6px;'>${formatNumber(interesesAcumulados, currency)}</td>`
                           + `<td style='padding:6px;'>${formatNumber(yearlyData[i], currency)}</td>`
                           + "</tr>";
            }
            tableHTML += "</tbody></table>";
            tableContainer.innerHTML = tableHTML;

            document.getElementById("finalConclusion").textContent = "El inter√©s compuesto es una herramienta financiera clave para construir patrimonio a largo plazo. Su eficacia depende directamente de dos factores: el tiempo que se mantenga la inversi√≥n y la constancia en las aportaciones. Aprovecharlo de forma disciplinada puede marcar la diferencia entre un ahorro com√∫n y un capital s√≥lido para el futuro.";


            const percIntereses = ((interests / total) * 100).toFixed(2);
            
            const totalInvertido = principal + totalContributions;
            explanationEl.textContent = `Con un capital inicial de ${formatNumber(principal, currency)} y aportando ${formatNumber(contribution, currency)} cada ${document.getElementById('frequency').options[document.getElementById('frequency').selectedIndex].text.toLowerCase()} durante ${years} a√±os, habr√≠as acumulado ${formatNumber(total, currency)} en total, de los cuales ${formatNumber(interests, currency)} provienen de intereses generados gracias al inter√©s compuesto.`;



            const ctxLine = document.getElementById('lineChart').getContext('2d');
            const ctxPie = document.getElementById('pieChart').getContext('2d');
            if (lineChart) lineChart.destroy();
            if (pieChart) pieChart.destroy();

            lineChart = new Chart(ctxLine, {
                type: 'line',
                data: { labels: Array.from({ length: years + 1 }, (_, i) => `A√±o ${i}`),
                        datasets: [{ label: 'Capital', data: yearlyData, borderColor: '#4f46e5', backgroundColor: 'rgba(79,70,229,0.2)', fill: true }] },
                options: { responsive: true, animation: { duration: 1000 } }
            });

            
            // Crear gr√°fico de barras extra: Capital aportado vs Intereses
            const ctxExtraBar = document.getElementById('barChartExtra').getContext('2d');
            if (window.extraBarChart) window.extraBarChart.destroy();
            window.extraBarChart = new Chart(ctxExtraBar, {
                type: 'bar',
                data: {
                    labels: ['Capital aportado', 'Intereses'],
                    datasets: [{
                        data: [totalContributions + principal, interests],
                        backgroundColor: ['#4f46e5', '#14b8a6']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    animation: { duration: 1000 }
                }
            });

            pieChart = new Chart(ctxPie, {
                type: 'pie',
                data: { labels: ['Capital inicial', 'Aportaciones', 'Intereses'],
                        datasets: [{ data: [principal, totalContributions, interests],
                                     backgroundColor: ['#4f46e5', '#14b8a6', '#9333ea'] }] },
                options: { responsive: true, animation: { duration: 1000 } }
            });

            localStorage.setItem("calcData", JSON.stringify({ currency, principal, rate: parseFloat((rate*100).toFixed(2)), years, contribution, frequency }));
        }

        inputs.forEach(input => input.addEventListener("input", calculate));

        document.addEventListener("DOMContentLoaded", () => {
            const saved = localStorage.getItem("calcData");
            if (saved) {
                const data = JSON.parse(saved);
                Object.keys(data).forEach(key => {
                    if (document.getElementById(key)) {
    if (key === 'rate') {
        document.getElementById(key).value = parseFloat(data[key]).toFixed(2);
    } else {
        document.getElementById(key).value = data[key];
    }
}
                });
            }
            calculate();
        });

        const themeToggle = document.getElementById("themeToggle");
        themeToggle.addEventListener("click", () => {
            document.body.classList.toggle("dark");
            themeToggle.textContent = document.body.classList.contains("dark") ? "‚òÄÔ∏è" : "üåô";
            localStorage.setItem("theme", document.body.classList.contains("dark") ? "dark" : "light");
        });
        if (localStorage.getItem("theme") === "dark") {
            document.body.classList.add("dark");
            themeToggle.textContent = "‚òÄÔ∏è";
        }

        async function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF("p", "mm", "a4");
            doc.setFontSize(18);
            doc.text("Resultados - Calculadora de Inter√©s Compuesto", 10, 20);
            doc.setFontSize(12);
            doc.text(`Total: ${resultEl.textContent}`, 10, 30);

            const lineImg = document.getElementById('lineChart').toDataURL('image/png');
            const pieImg = document.getElementById('pieChart').toDataURL('image/png');
const barExtraImg = document.getElementById('barChartExtra').toDataURL('image/png');
            doc.addImage(lineImg, 'PNG', 10, 40, 180, 60);
            doc.addImage(pieImg, 'PNG', 10, 110, 100, 80);
doc.addImage(barExtraImg, 'PNG', 110, 110, 80, 80);

            
            const tableElement = document.querySelector("#table-container");
            const canvas = await html2canvas(tableElement);
            const tableImg = canvas.toDataURL("image/png");
            doc.addPage();
            doc.addImage(tableImg, 'PNG', 10, 20, 190, 0);

            doc.save("resultado_interes_compuesto.pdf");
    
        }
    </script>
</body>
</html>
